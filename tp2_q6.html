<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>tp2_q6.c</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
<!--
body {color: #000000; background-color: #ffffff; font-family: Monospaced}
pre {color: #000000; background-color: #ffffff; font-family: Monospaced}
table {color: #000000; background-color: #e9e8e2; font-family: Monospaced}
.ST0 {color: #969696; background-color: #e9eff8}
.ST2 {font-family: Monospaced; font-weight: bold}
.preprocessor {color: #009b00}
.comment {color: #969696}
.literal {color: #0000e6}
.pragma-omp-keyword-directive {color: #2e92c7}
.ST1 {background-color: #eceba3}
.string {color: #ce7b00}
-->
</style>
</head>
<body>
<table width="100%"><tr><td align="center">C:\Users\Jean-Claude\Desktop\IUT\S2\ARCHITECTURE DES SYSTEMES\TP\TP02_FF\tp2_q6.c</td></tr></table>
<pre>
 1 <span class="ST0">/**</span><span class="ST0">*********************************************</span><span class="ST0">*/</span>
 2 <span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="string">&quot;iq.h&quot;</span>
 3 <span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="string">&quot;it.h&quot;</span>
 4 <span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="pragma-omp-keyword-directive">byte</span> <span class="literal">unsigned</span> <span class="literal">char</span>
 5 
 6 <span class="comment">/*</span> <span class="comment">variables</span> <span class="comment">globale</span> <span class="comment">*/</span>
 7 <span class="pragma-omp-keyword-directive">byte</span> *trisb = 0xf93 ;
 8 <span class="pragma-omp-keyword-directive">byte</span> *portb = 0xf81 ;
 9 <span class="pragma-omp-keyword-directive">byte</span> *trisd = 0xf95 ;
10 <span class="pragma-omp-keyword-directive">byte</span> *portd = 0xf83 ;
11 
12 <span class="literal">int</span> <span class="ST1">i</span>=0;
13 <span class="literal">int</span> nb=0;
14 
15 <span class="literal">void</span> <span class="ST2">affiche_7seg</span>(<span class="pragma-omp-keyword-directive">byte</span>);
16 
17 <span class="comment">/*</span> <span class="comment">interruption</span> <span class="comment">sur</span> <span class="comment">front</span> <span class="comment">montant</span> <span class="comment">RB0</span> <span class="comment">*/</span>
18 <span class="literal">void</span> <span class="ST2">it_int0</span>()
19 {
20         <span class="ST1">i</span>++;
21 }
22 
23 <span class="comment">/*</span> <span class="comment">interruption</span> <span class="comment">sur</span> <span class="comment">front</span> <span class="comment">montant</span> <span class="comment">RB1</span> <span class="comment">*/</span>
24 <span class="literal">void</span> <span class="ST2">it_int1</span>()
25 {
26         <span class="ST1">i</span>--;    
27 }
28 
29 <span class="literal">void</span> <span class="ST2">it_tmr0</span>()
30 {
31     <span class="ST1">i</span>++;
32         delayms(600);
33 }
34 
35 <span class="literal">void</span> <span class="ST2">affiche_7seg</span>(<span class="pragma-omp-keyword-directive">byte</span> val)
36 {
37         <span class="pragma-omp-keyword-directive">byte</span> tab_7seg[]={0b00111111,0b00000110,0b01011011,0b01001111,0b01100110,0b01101101,
38         0b01111101,0b00000111,0b01111111,0b01101111};
39         *portd=tab_7seg[val];
40 }
41 
42 
43         
44 <span class="literal">void</span> <span class="ST2">main</span>(<span class="literal">void</span>)
45 {
46         *trisd = 0 ;
47         *trisb = 0xff;
48         init_it_tmr0();
49         init_it_int0();
50         init_it_int1();
51         affiche_7seg(<span class="ST1">i</span>);
52 
53         <span class="literal">while</span>(1)
54         {
55                 affiche_7seg(<span class="ST1">i</span>);
56         }
57 }
58 <span class="comment">/**</span><span class="comment">*********************************************</span><span class="comment">*/</span>
59 
</pre></body>
</html>
